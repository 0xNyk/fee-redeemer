(this["webpackJsonpandys-fee-redeemer"]=this["webpackJsonpandys-fee-redeemer"]||[]).push([[0],{308:function(e,n,t){},309:function(e,n,t){},311:function(e,n){},313:function(e,n){},319:function(e,n){},328:function(e,n){},329:function(e,n){},356:function(e,n){},358:function(e,n){},361:function(e,n){},418:function(e,n){},420:function(e,n){},431:function(e,n){},435:function(e,n){},437:function(e,n){},447:function(e,n){},449:function(e,n){},480:function(e,n){},482:function(e,n){},489:function(e,n){},490:function(e,n){},511:function(e,n){},512:function(e,n,t){"use strict";t.r(n);var c=t(1),r=t.n(c),a=t(28),s=t.n(a),o=(t(308),t(309),t(16)),i=t(17),u=t(4),b=t(11),l=t(2),f=t.n(l),p=t(547),d=t(546),j=t(5),x=t(47),O=t(149),v=t(153);function h(e,n){return m.apply(this,arguments)}function m(){return(m=Object(u.a)(f.a.mark((function e(n,t){var c,r,a,s,o,u,b,l,p,d;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getTokenAccountsByOwner(t,{programId:v.a});case 2:c=e.sent,console.log(c),r=[],a=0,s=Object(i.a)(c.value),e.prev=7,s.s();case 9:if((o=s.n()).done){e.next=33;break}if(u=o.value,console.log(u.pubkey.toBase58()),b=!1,l=64,!u.account.data.readBigUInt64LE){e.next=20;break}p=u.account.data.readBigUInt64LE(l),console.log("amount: "+p),b=0n===p,e.next=30;break;case 20:b=!0,d=0;case 22:if(!(d<8)){e.next=29;break}if(0===u.account.data[l+d]){e.next=26;break}return b=!1,e.abrupt("break",29);case 26:d++,e.next=22;break;case 29:console.log("account empty: "+b);case 30:b&&(console.log("account empty!"),r.push(u.pubkey),a+=u.account.lamports);case 31:e.next=9;break;case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(7),s.e(e.t0);case 38:return e.prev=38,s.f(),e.finish(38);case 41:return e.abrupt("return",{publicKeys:r,size:r.length,amount:a/j.LAMPORTS_PER_SOL});case 42:case"end":return e.stop()}}),e,null,[[7,35,38,41]])})))).apply(this,arguments)}function k(e,n){return g.apply(this,arguments)}function g(){return(g=Object(u.a)(f.a.mark((function e(n,t){var c,r,a,s,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.map((function(e){return v.b.createCloseAccountInstruction(v.a,e,n,n,[])})),r=[];case 2:if(!(c.length>0)){e.next=18;break}a=new j.Transaction,s=0;case 5:if(!(s<20)){e.next=15;break}if(!(o=c.pop())){e.next=11;break}a.add(o),e.next=12;break;case 11:return e.abrupt("break",15);case 12:s++,e.next=5;break;case 15:r.push(a),e.next=2;break;case 18:return e.abrupt("return",r);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=t(36),w=function(e){var n=e.connection,t=Object(c.useState)(),r=Object(b.a)(t,2),a=r[0],s=r[1],l=Object(c.useState)(),v=Object(b.a)(l,2),m=v[0],g=v[1],w=Object(c.useState)({open:!1,message:"",severity:void 0}),S=Object(b.a)(w,2),L=S[0],C=S[1],R=Object(x.d)(),B=Object(x.c)(),T=function(){Object(u.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=2;break}return e.abrupt("return");case 2:return console.log("Finding empty token accounts"),e.next=5,h(n,B.publicKey);case 5:t=e.sent,console.log("Found  "+t.size),g(t);case 8:case"end":return e.stop()}}),e)})))()};Object(c.useEffect)(T,[B,n]),Object(c.useEffect)((function(){Object(u.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!B){e.next=5;break}return e.next=3,n.getBalance(B.publicKey);case 3:t=e.sent,s(t/j.LAMPORTS_PER_SOL);case 5:case"end":return e.stop()}}),e)})))()}),[B,n]);var E=function(){var t=Object(u.a)(f.a.mark((function t(){var c,r,a,o,u,b,l,p;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(B&&m&&m.size>0)){t.next=29;break}return t.next=4,k(B.publicKey,m.publicKeys);case 4:c=t.sent,r=Object(i.a)(c),t.prev=6,r.s();case 8:if((a=r.n()).done){t.next=21;break}return o=a.value,t.next=12,R.sendTransaction(o,n);case 12:return u=t.sent,console.log(u),console.log("Redeem sent"),t.next=17,n.confirmTransaction(u,"confirmed");case 17:(b=t.sent).value.err?C({open:!0,message:b.value.err.toString(),severity:"warning"}):C({open:!0,message:"Successfully redeemed some SOL!",severity:"success"});case 19:t.next=8;break;case 21:t.next=26;break;case 23:t.prev=23,t.t0=t.catch(6),r.e(t.t0);case 26:return t.prev=26,r.f(),t.finish(26);case 29:t.next=35;break;case 31:t.prev=31,t.t1=t.catch(0),l=t.t1.msg||"Redeem failed!",C({open:!0,message:l,severity:"error"});case 35:if(t.prev=35,!B){t.next=41;break}return t.next=39,e.connection.getBalance(B.publicKey);case 39:p=t.sent,s(p/j.LAMPORTS_PER_SOL);case 41:return T(),t.finish(35);case 43:case"end":return t.stop()}}),t,null,[[0,31,35,43],[6,23,26,29]])})));return function(){return t.apply(this,arguments)}}();return Object(y.jsx)("main",{children:Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh"},children:[Object(y.jsx)("h1",{children:"Fee Redeemer"}),Object(y.jsx)("div",{children:B?Object(y.jsxs)("div",{children:[m&&Object(y.jsxs)("p",{children:["You have ",null===m||void 0===m?void 0:m.size," empty token accounts and could redeem ",null===m||void 0===m?void 0:m.amount," SOL!"]}),Object(y.jsx)("button",{disabled:!B,onClick:E,children:"Redeem"}),B&&Object(y.jsxs)("p",{children:["Your Balance: ",(a||0).toLocaleString()," SOL"]})]}):Object(y.jsx)(O.a,{children:"Connect Wallet"})}),Object(y.jsx)(p.a,{open:L.open,autoHideDuration:6e3,onClose:function(){return C(Object(o.a)(Object(o.a)({},L),{},{open:!1}))},children:Object(y.jsx)(d.a,{onClose:function(){return C(Object(o.a)(Object(o.a)({},L),{},{open:!1}))},severity:L.severity,children:L.message})})]})})},S=t(150),L=t(106),C=j.clusterApiUrl("mainnet-beta"),R=new S.b.Connection(C);var B=function(){var e=c.useMemo((function(){return C}),[]),n=c.useMemo((function(){return[Object(L.a)(),Object(L.b)(),Object(L.c)(),Object(L.e)({network:C}),Object(L.d)({network:C})]}),[]);return Object(y.jsx)(x.a,{endpoint:e,children:Object(y.jsx)(x.b,{wallets:n,autoConnect:!0,children:Object(y.jsx)(O.b,{children:Object(y.jsx)(w,{connection:R})})})})},T=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,548)).then((function(n){var t=n.getCLS,c=n.getFID,r=n.getFCP,a=n.getLCP,s=n.getTTFB;t(e),c(e),r(e),a(e),s(e)}))};s.a.render(Object(y.jsx)(r.a.StrictMode,{children:Object(y.jsx)(B,{})}),document.getElementById("root")),T()}},[[512,1,2]]]);
//# sourceMappingURL=main.dc37e5ee.chunk.js.map